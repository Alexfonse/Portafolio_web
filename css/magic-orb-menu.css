/* =========================================
   ARCANE MAGICAL MENU - REIMAGINED
   ========================================= */

/* Base Container - Centered at bottom */
.menu-navegar {
    position: fixed; /* Fixed to follow scroll */
    bottom: 40px;
    left: 50%;
    transform: translateX(-50%);
    width: 250px; /* Larger area for rings */
    height: 250px;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    pointer-events: none; /* Let clicks pass through empty space */
}

/* HIDE STATE (Scroll Logic) */
.menu-navegar.hide-menu {
    opacity: 0;
    transform: translateX(-50%) scale(0.5);
    pointer-events: none;
    transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

/* =========================================
   CORE COMPONENT (Clickable Orb)
   ========================================= */
.toggleMenu {
    position: relative;
    width: 70px;
    height: 70px;
    background: radial-gradient(circle at 30% 30%, #ffffff 0%, #dcdcdc 20%, var(--color-primary) 100%);
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 2.5em;
    z-index: 1002;
    pointer-events: auto; /* Re-enable clicks */
    box-shadow: 
        0 0 20px rgba(0, 217, 255, 0.6),
        0 0 60px rgba(0, 217, 255, 0.3),
        inset -5px -5px 15px rgba(0, 0, 0, 0.3);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    border: 2px solid rgba(255, 255, 255, 0.4);
}

.toggleMenu ion-icon {
    color: #000;
    transition: transform 0.4s ease;
}

/* Hover State on Core */
.toggleMenu:hover {
    transform: scale(1.1) rotate(90deg);
    box-shadow: 
        0 0 30px rgba(0, 217, 255, 0.8),
        0 0 80px rgba(157, 78, 221, 0.5),
        inset 0 0 20px rgba(255, 255, 255, 0.8);
}

/* Active State (Menu Open) */
.menu-navegar.menu-open .toggleMenu {
    transform: rotate(45deg);
    background: radial-gradient(circle at 30% 30%, #ffcccc 0%, #ff9999 20%, #ff0055 100%);
    box-shadow: 0 0 40px rgba(255, 0, 85, 0.6);
}

/* =========================================
   RUNIC RINGS (Decorations)
   ========================================= */
.runic-ring {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    border-radius: 50%;
    pointer-events: none;
    border: 1px dashed rgba(0, 217, 255, 0.3);
    transition: all 0.5s ease;
}

/* Inner Ring - Fast Rotation */
.ring-inner {
    width: 90px;
    height: 90px;
    border: 1px solid rgba(157, 78, 221, 0.4);
    border-top-color: transparent;
    border-bottom-color: transparent;
    animation: rotateRune 4s linear infinite;
}

/* Outer Ring - Slow Rotation */
.ring-outer {
    width: 140px;
    height: 140px;
    border: 1px dotted rgba(0, 217, 255, 0.2);
    animation: rotateRuneReverse 12s linear infinite;
}

/* Hover/Open States for Rings */
.menu-navegar:hover .ring-inner,
.menu-navegar.menu-open .ring-inner {
    width: 110px;
    height: 110px;
    border-color: rgba(0, 217, 255, 0.8);
    box-shadow: 0 0 20px rgba(0, 217, 255, 0.2);
}

.menu-navegar:hover .ring-outer,
.menu-navegar.menu-open .ring-outer {
    width: 220px;
    height: 220px;
    border-color: rgba(157, 78, 221, 0.5);
    border-style: solid;
    border-width: 1px;
}

/* =========================================
   MENU ITEMS (Orbital)
   ========================================= */
.menu_item {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 50px;
    height: 50px;
    background: rgba(10, 14, 39, 0.95);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    border: 1px solid var(--color-primary);
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1001;
    pointer-events: auto;
    
    /* Centered by default */
    transform: translate(-50%, -50%) scale(0.1);
    opacity: 0;
    transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

/* OPEN/HOVER Logic */
.menu-navegar:hover .menu_item,
.menu-navegar.menu-open .menu_item {
    opacity: 1;
    /* Deploy to radius (100px) based on --angle */
    transform: translate(-50%, -50%) rotate(var(--angle)) translate(100px) rotate(calc(-1 * var(--angle))) scale(1);
}

/* Staggered Delay relative to angle (Pure CSS Math not possible for delay without generic index, using universal delay for now) */
.menu-navegar:hover .menu_item:nth-child(1), .menu-navegar.menu-open .menu_item:nth-child(1) { transition-delay: 0.05s; }
.menu-navegar:hover .menu_item:nth-child(2), .menu-navegar.menu-open .menu_item:nth-child(2) { transition-delay: 0.1s; }
.menu-navegar:hover .menu_item:nth-child(3), .menu-navegar.menu-open .menu_item:nth-child(3) { transition-delay: 0.15s; }
.menu-navegar:hover .menu_item:nth-child(4), .menu-navegar.menu-open .menu_item:nth-child(4) { transition-delay: 0.2s; }

/* Item Icons */
.menu_item a {
    color: var(--color-primary);
    font-size: 1.5rem;
    transition: all 0.3s ease;
    display: flex; /* Fix centered icon */
    width: 100%;
    height: 100%;
    justify-content: center;
    align-items: center;
    border-radius: 50%;
}

/* Item Hover Effect */
.menu_item:hover {
    background: var(--color-primary);
    box-shadow: 
        0 0 15px var(--color-primary),
        0 0 30px var(--color-primary);
    border-color: #fff;
    transform: translate(-50%, -50%) rotate(var(--angle)) translate(115px) rotate(calc(-1 * var(--angle))) scale(1.2) !important;
}

.menu_item:hover a {
    color: #000;
}

/* Tooltips */
.menu_item::after {
    content: attr(aria-label); /* Requires JS to copy aria-label to local usage or explicit content */
    /* Fallback: We can't access A's aria-label easily from LI css without simple JS or structure change. 
       Assuming structure is li -> a. 
       Actually, standard is simpler: we won't do CSS tooltips to avoid clutter, focus on icons.
    */
    display: none; 
}

/* =========================================
   ANIMATIONS
   ========================================= */
@keyframes rotateRune {
    0% { transform: translate(-50%, -50%) rotate(0deg); }
    100% { transform: translate(-50%, -50%) rotate(360deg); }
}

@keyframes rotateRuneReverse {
    0% { transform: translate(-50%, -50%) rotate(360deg); }
    100% { transform: translate(-50%, -50%) rotate(0deg); }
}

/* Mobile Adjustments */
@media (max-width: 768px) {
    .menu-navegar {
        bottom: 20px;
        right: 20px;
        left: auto;
        transform: none;
    }
    
    .menu-navegar.hide-menu {
        transform: scale(0);
        opacity: 0;
    }
    
    /* Deploy upwards/left on mobile corner */
    .menu-navegar:hover .menu_item,
    .menu-navegar.menu-open .menu_item {
        /* Mobile specific radial deploy - same logic works if container is well placed */
         transform: translate(-50%, -50%) rotate(var(--angle)) translate(85px) rotate(calc(-1 * var(--angle))) scale(1);
    }
}

/* =========================================
   ARCANE BURST PARTICLES (JS Triggered)
   ========================================= */
.arcane-particle {
    position: fixed;
    width: 8px;
    height: 8px;
    background: var(--color-accent, #FFD60A);
    border-radius: 50%;
    pointer-events: none;
    z-index: 9999;
    /* Animation driven by transition for performance or keyframe if complex */
    animation: arcane-burst 0.8s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
}

@keyframes arcane-burst {
    0% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
        box-shadow: 0 0 15px var(--color-accent);
    }
    100% {
        transform: translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) scale(0);
        opacity: 0;
    }
}
